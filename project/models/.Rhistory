post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC) * 0.01)
)
df
ggplot() +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "red") +
geom_line(aes(lambda, post.NBA), col = "red") +
ggplot() +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "red") +
geom_line(aes(lambda, post.NBA), col = "red")
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "red") +
geom_line(aes(lambda, post.NBA), col = "red")
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA)),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC) * 0.01)
)
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "red") +
geom_line(aes(lambda, post.NBA), col = "red")
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA) * 0.01),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC) * 0.01)
)
df
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA)),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC))
)
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "red") +
geom_line(aes(lambda, post.NBA), col = "red")
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "blue") +
geom_line(aes(lambda, post.NBA), col = "green")
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA) * 0.01),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC))
)
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "blue") +
geom_line(aes(lambda, post.NBA), col = "green")
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "blue")
lik.NBA <- lik.NBA / (sum(lik.NBA) * 0.01)
data <- read.table("./basquet.txt")
data.NBA <- as.numeric(data[-1,2])
data.ABC <- as.numeric(data[-1,1])
lambda <- seq(130, 270, 0.01)
lik.NBA <- map_dbl(lambda, ~ prod(dpois(data.NBA, .x)))
lik.ABC <- map_dbl(lambda, ~ prod(dpois(data.ABC, .x)))
lik.NBA <- lik.NBA / (sum(lik.NBA) * 0.01)
df <- tibble(lambda, lik.NBA, lik.ABC)
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA) * 0.01),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC))
)
ggplot(df) +
geom_line(aes(lambda, prior.NBA), col = "red") +
geom_line(aes(lambda, lik.NBA), col = "blue") +
geom_line(aes(lambda, post.NBA), col = "green")
df %>%
gather(key = Distribution, value = value, -lambda) %>%
ggplot() +
geom_line(aes(x = lambda, y = value, col = Distribution))
sum(lik.ABC)
sum(lik.NBA)
sum(data.NBA)
sum(data.ABC)
sum(lik.NBA)
sum(lik.ABC)
lik.NBA <- map_dbl(lambda, ~ prod(dpois(data.NBA, .x)))
lik.ABC <- map_dbl(lambda, ~ prod(dpois(data.ABC, .x)))
sum(lik.NBA)
sum(lik.ABC)
lik.NBA <- lik.NBA / (sum(lik.NBA) * 0.01)
lik.ABC <- lik.ABC / (sum(lik.ABC) * 0.01)
sum(lik.NBA)
sum(lik.ABC)
data <- read.table("./basquet.txt")
data.NBA <- as.numeric(data[-1,2])
data.ABC <- as.numeric(data[-1,1])
lambda <- seq(130, 270, 0.01)
lik.NBA <- map_dbl(lambda, ~ prod(dpois(data.NBA, .x)))
lik.ABC <- map_dbl(lambda, ~ prod(dpois(data.ABC, .x)))
lik.NBA <- lik.NBA / (sum(lik.NBA) * 0.01)
lik.ABC <- lik.ABC / (sum(lik.ABC) * 0.01)
df <- tibble(lambda, lik.NBA, lik.ABC)
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA) * 0.01),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC) * 0.01)
)
df %>%
gather(key = Distribution, value = value, -lambda) %>%
ggplot() +
geom_line(aes(x = lambda, y = value, col = Distribution))
?dnbinom
n <- length(data.ABC[-1,1])
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(purrr)
prior.NBA <- c(500, 2.5)
prior.ABC <- c(425, 2.5)
data <- read.table("./basquet.txt")
data.NBA <- as.numeric(data[-1,2])
data.ABC <- as.numeric(data[-1,1])
lambda <- seq(130, 270, 0.01)
lik.NBA <- map_dbl(lambda, ~ prod(dpois(data.NBA, .x)))
lik.ABC <- map_dbl(lambda, ~ prod(dpois(data.ABC, .x)))
lik.NBA <- lik.NBA / (sum(lik.NBA) * 0.01)
lik.ABC <- lik.ABC / (sum(lik.ABC) * 0.01)
df <- tibble(lambda, lik.NBA, lik.ABC)
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA) * 0.01),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC) * 0.01)
)
df %>%
gather(key = Distribution, value = value, -lambda) %>%
ggplot() +
geom_line(aes(x = lambda, y = value, col = Distribution))
M <- 10000  # Number of simulations
n <- length(data.ABC[-1,1])
n <- length(data.ABC)
mean(y.sim)
post.NBA <- c(prior.NBA[1] + sum(data.NBA), prior.NBA[2] + length(data.NBA))
post.ABC <- c(prior.ABC[1] + sum(data.ABC), prior.ABC[2] + length(data.ABC))
y.sim <- rpois(M, post.NBA) - rpois(M, post.ABC)
mean(y.sim)
y.sim
post.NBA
lam.post.NBA <- rgamma(M, shape = post.NBA[1], rate = post.NBA[2])
lam.post.ABC <- rgamma(M, shape = post.ABC[1], rate = post.ABC[2])
y.sim <- rpois(M, lam.post.NBA) - rpois(M, lam.post.ABC)
post.NBA <- c(prior.NBA[1] + sum(data.NBA), prior.NBA[2] + length(data.NBA))
post.ABC <- c(prior.ABC[1] + sum(data.ABC), prior.ABC[2] + length(data.ABC))
lam.post.NBA <- rgamma(M, shape = post.NBA[1], rate = post.NBA[2])
lam.post.ABC <- rgamma(M, shape = post.ABC[1], rate = post.ABC[2])
y.sim <- rpois(M, lam.post.NBA) - rpois(M, lam.post.ABC)
mean(y.sim)
length(y.sim > 0)
length(y.sim > 0)
y.sim
y.sim[y.sim > 0]
length(y.sim[y.sim > 0])
# Probability that NBA match has more points than ABC match
length(y.sim[y.sim > 0]) / M
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(purrr)
prior.NBA <- c(500, 2.5)
prior.ABC <- c(425, 2.5)
data <- read.table("./basquet.txt")
data.NBA <- as.numeric(data[-1,2])
data.ABC <- as.numeric(data[-1,1])
lambda <- seq(130, 270, 0.01)
lik.NBA <- map_dbl(lambda, ~ prod(dpois(data.NBA, .x)))
lik.ABC <- map_dbl(lambda, ~ prod(dpois(data.ABC, .x)))
lik.NBA <- lik.NBA / (sum(lik.NBA) * 0.01)
lik.ABC <- lik.ABC / (sum(lik.ABC) * 0.01)
df <- tibble(lambda, lik.NBA, lik.ABC)
df <- df %>%
mutate(
prior.NBA = dgamma(lambda, shape = prior.NBA[1], rate = prior.NBA[2]),
prior.ABC = dgamma(lambda, shape = prior.ABC[1], rate = prior.ABC[2]),
post.NBA = prior.NBA * lik.NBA / (sum(prior.NBA * lik.NBA) * 0.01),
post.ABC = prior.ABC * lik.ABC / (sum(prior.ABC * lik.ABC) * 0.01)
)
df %>%
gather(key = Distribution, value = value, -lambda) %>%
ggplot() +
geom_line(aes(x = lambda, y = value, col = Distribution))
M <- 10000  # Number of simulations
set.seed(666)
post.NBA <- c(prior.NBA[1] + sum(data.NBA), prior.NBA[2] + length(data.NBA))
post.ABC <- c(prior.ABC[1] + sum(data.ABC), prior.ABC[2] + length(data.ABC))
lam.post.NBA <- rgamma(M, shape = post.NBA[1], rate = post.NBA[2])
lam.post.ABC <- rgamma(M, shape = post.ABC[1], rate = post.ABC[2])
y.sim <- rpois(M, lam.post.NBA) - rpois(M, lam.post.ABC)
# Probability that NBA match has more points than ABC match
length(y.sim[y.sim > 0]) / M
length(y.sim[y.sim >= 0]) / M
length(y.sim[y.sim >= 60]) / M
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rstan)
library(bayesplot)
options(mc.cores = parallel::detectCores())
Y_A <- c(115, 120, 111, 123, 116,
121, 118, 116, 127, 129)
Y_B <- c(123, 131, 113, 119, 123,
113, 128, 126, 125, 128)
data = list(n_A = length(Y_A), n_B = length(Y_B),
Y_A = Y_A, Y_B = Y_B)
fit <- stan("./stan_model/training_workers.stan", iter = 1000, chains = 4,
data = data)
fit
posterior <- as.matrix(fit)
mu_A_post <- posterior[,"mu_A"]
mu_B_post <- posterior[,"mu_B"]
acf(mu_A_post)
acf(mu_B_post)
traceplot(fit)
plot(density(mu_A_post))
plot(density(mu_B_post))
plot_title <- ggtitle("Posterior distributions of mu_A and mu_B", "with medians and 80% intervals")
mcmc_areas(posterior,
pars = c("mu_A", "mu_B"),
prob = 0.8) + plot_title
mcmc_trace(posterior,
pars = c("mu_A", "mu_B"),
facet_args = list(nrow = 2))
diff <- mu_A_post - mu_B_post
plot(density(diff))
plot(density(posterior[,"diff"]))
quantile(diff)
?quantile
quantile(diff, c(0.025, 0.975))
quantile(posterior[,"diff"], c(0.025, 0.975))
quantile(posterior[,"diff"], c(0.025, 0.975))
plot(density(posterior[,"diff"]))
quantile(posterior[,"diff"], c(0.025, 0.975))
plot(density(posterior[,"diff"]))
mcmc_trace(posterior,
pars = c("mu_A", "mu_B"),
facet_args = list(nrow = 2))
mcmc_areas(posterior,
pars = c("mu_A", "mu_B"),
prob = 0.8) + plot_title
mcmc_areas(posterior,
pars = c("diff"),
prob = 0.8) + plot_title
mcmc_areas(posterior,
pars = c("diff"),
prob = c(0.025, 0.975)) + plot_title
mcmc_areas(posterior,
pars = c("diff"),
prob = c(0.25, 0.975)) + plot_title
mcmc_areas(posterior,
mcmc_areas(posterior,
mcmc_areas(posterior,
pars = c("diff"),
prob = 0.95) + plot_title
)
}
mcmc_areas(posterior,
pars = c("diff"),
prob = 0.95) + plot_title
plot_title <- ggtitle("Posterior distributions of mu_A - mu_B", "with median and 95% credible interval")
mcmc_areas(posterior,
pars = c("diff"),
prob = 0.95) + plot_title
quantile(posterior[,"diff"], c(0.025, 0.975))
plot_title <- ggtitle("Posterior distributions of mu_A - mu_B", "with median and 95% credible interval")
mcmc_areas(posterior,
pars = c("diff"),
prob = 0.95) + plot_title
quantile(posterior[,"diff"], c(0.025, 0.975))
plot_title <- ggtitle("Posterior distributions of mu_A - mu_B", "with median and 95% credible interval")
mcmc_areas(posterior,
pars = c("diff"),
prob = 0.95) + plot_title
install.packages("stringi")
gam <- rgamma(1000, 1, rate = 1)
plot(gam)
hist(gam)
gam <- rgamma(1000, 5, rate = 1)
hist(gam)
hist(gam)
?dgamma
1:10:0.1
knitr::opts_chunk$set(echo = TRUE)
plot(function(x)dgamma(x,shape=6,rate=1))
plot(function(x)dgamma(x,shape=6,rate=1),xlim=c(0,10))
plot(function(x)dgamma(x,shape=6,rate=5),xlim=c(0,20))
plot(function(x)dgamma(x,shape=6,rate=0.01),xlim=c(0,20))
plot(function(x)dgamma(x,shape=100,rate=20),xlim=c(0,20))
plot(function(x)dgamma(x,shape=1,rate=0.2),xlim=c(0,20))
plot(function(x)dgamma(x,shape=10,rate=2),xlim=c(0,20))
plot(function(x)dgamma(x,shape=5,rate=1),xlim=c(0,20))
plot(function(x)dgamma(x,shape=5,rate=1),xlim=c(0,20))
plot(function(x)dgamma(x,shape=1,rate=0.1),xlim=c(0,20))
plot(function(x)dgamma(x,shape=2,rate=0.1),xlim=c(0,20))
plot(function(x)dgamma(x,shape=2,rate=0.2),xlim=c(0,20))
plot(function(x)dgamma(x,shape=2,rate=0.3),xlim=c(0,20))
plot(function(x)dgamma(x,shape=2,rate=0.33),xlim=c(0,20))
?rstan
library(rstan)
?rstan
library(rstan)
library(bayesplot)
library(tidyverse)
setwd("~/Documents/colab/bayesian/project/models")
library(rstan)
library(bayesplot)
library(tidyverse)
library(Hmisc)
library(ggplot2)
library(xtable)
set.seed(1234)
# Read the data that was cleaned in "erasmus.R".
data <- read.csv("../cleaned.csv")
summary(data)
dim(data)
# Change the data types again.
data <- data %>% transmute(duration = as.numeric(duration),
age = as.numeric(age),
gender = as.factor(gender),
nationality = as.factor(nationality),
sending.country = as.factor(sending.country),
receiving.country = as.factor(receiving.country),
activity = as.factor(activity),
participants = participants)
describe(data)
# We want to model the duration of the student exchange.
dur <- data$duration
any(is.na(dur)) # Checking to be sure that there are no NA here.
points <- 500
data_list <- list(
n=points,
y=sample(dur, size = points) # Sample `points` number of points from the dataset.
)
fit1 <- stan("../stan_models/model3.stan", iter = 1000, chains = 4,
data = data_list, seed = 1)
# Convergence analysis.
print(fit1)
traceplot(fit1)
# Lag en ok LaTeX tabell!
xtable(summary(fit1)$summary)
posterior <- as.data.frame(fit1)
y_pred <- posterior[, "y_pred"]
plot(density(y_pred))
tibble(y_pred) %>%
ggplot(aes(y_pred)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
ggtitle("Mix of Gaussian")
ggsave("../626fca86090ba51a6aff419a/plots/postpred3.pdf", width = 7, height = 5)
# We select the statistics 1st quart, median and 3rd quart.
q.sim <- quantile(y_pred, c(0.25, 0.5, 0.75))
q.sim
# Compare with the same statistics in the data.
q.data <- quantile(dur, c(0.25, 0.5, 0.75))
q.data
set.seed(1234)
# Read the data that was cleaned in "erasmus.R".
data <- read.csv("../cleaned.csv")
summary(data)
dim(data)
# Change the data types again.
data <- data %>% transmute(duration = as.numeric(duration),
age = as.numeric(age),
gender = as.factor(gender),
nationality = as.factor(nationality),
sending.country = as.factor(sending.country),
receiving.country = as.factor(receiving.country),
activity = as.factor(activity),
participants = participants)
describe(data)
# We want to model the duration of the student exchange.
dur <- data$duration
any(is.na(dur)) # Checking to be sure that there are no NA here.
points <- 5000
data_list <- list(
n=points,
y=sample(dur, size = points) # Sample `points` number of points from the dataset.
)
fit1 <- stan("../stan_models/model3.stan", iter = 1000, chains = 4,
data = data_list, seed = 1)
# Convergence analysis.
print(fit1)
traceplot(fit1)
# Lag en ok LaTeX tabell!
xtable(summary(fit1)$summary)
posterior <- as.data.frame(fit1)
y_pred <- posterior[, "y_pred"]
plot(density(y_pred))
tibble(y_pred) %>%
ggplot(aes(y_pred)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
ggtitle("Mix of Gaussian")
ggsave("../626fca86090ba51a6aff419a/plots/postpred3.pdf", width = 7, height = 5)
# We select the statistics 1st quart, median and 3rd quart.
q.sim <- quantile(y_pred, c(0.25, 0.5, 0.75))
q.sim
# Compare with the same statistics in the data.
q.data <- quantile(dur, c(0.25, 0.5, 0.75))
q.data
library(rstan)
library(bayesplot)
library(tidyverse)
library(Hmisc)
library(ggplot2)
library(xtable)
set.seed(1234)
# Read the data that was cleaned in "erasmus.R".
data <- read.csv("../cleaned.csv")
summary(data)
dim(data)
# Change the data types again.
data <- data %>% transmute(duration = as.numeric(duration),
age = as.numeric(age),
gender = as.factor(gender),
nationality = as.factor(nationality),
sending.country = as.factor(sending.country),
receiving.country = as.factor(receiving.country),
activity = as.factor(activity),
participants = participants)
describe(data)
# Omit the unknown genders for our regression model
data <- data %>% filter(gender == "Female" | gender == "Male")
summary(data)
data$gender <- as.integer(data$gender) - 1
describe(data)
points <- 500
sample_df <- data[sample(1:nrow(data), points),]
summary(sample_df)
data_list <- list(
n=points,
y=sample_df$duration,
x1=sample_df$age,
x2=sample_df$gender
)
fit1 <- stan("../stan_models/model4.stan", iter = 1000, chains = 4,
data = data_list, seed = 1)
# Convergence analysis.
print(fit1)
traceplot(fit1)
# Lag en ok LaTeX tabell!
xtable(summary(fit1)$summary)
posterior <- as.data.frame(fit1)
y_pred <- posterior[, "y_pred"]
plot(density(y_pred))
tibble(y_pred) %>%
ggplot(aes(y_pred)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
ggtitle("Mix of Gaussian")
ggsave("../626fca86090ba51a6aff419a/plots/postpred4.pdf", width = 7, height = 5)
# We select the statistics 1st quart, median and 3rd quart.
q.sim <- quantile(y_pred, c(0.25, 0.5, 0.75))
q.sim
# Compare with the same statistics in the data.
q.data <- quantile(data$duration, c(0.25, 0.5, 0.75))
q.data
points <- 5000
sample_df <- data[sample(1:nrow(data), points),]
summary(sample_df)
data_list <- list(
n=points,
y=sample_df$duration,
x1=sample_df$age,
x2=sample_df$gender
)
fit1 <- stan("../stan_models/model4.stan", iter = 1000, chains = 4,
data = data_list, seed = 1)
# Convergence analysis.
print(fit1)
# Convergence analysis.
print(fit1)
traceplot(fit1)
# Lag en ok LaTeX tabell!
xtable(summary(fit1)$summary)
posterior <- as.data.frame(fit1)
y_pred <- posterior[, "y_pred"]
plot(density(y_pred))
tibble(y_pred) %>%
ggplot(aes(y_pred)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
ggtitle("Mix of Gaussian")
ggsave("../626fca86090ba51a6aff419a/plots/postpred4.pdf", width = 7, height = 5)
# We select the statistics 1st quart, median and 3rd quart.
q.sim <- quantile(y_pred, c(0.25, 0.5, 0.75))
q.sim
# Compare with the same statistics in the data.
q.data <- quantile(data$duration, c(0.25, 0.5, 0.75))
q.data
quantile(posterior$beta1)
quantile(posterior$beta2)
quantile(posterior$beta1, c(0.025, 0.975))
quantile(posterior$beta1, c(0.025, 0.975))
quantile(posterior$beta2, c(0.025, 0.975))
mean(posterior$beta1)
